<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plots · AnyMOD.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="AnyMOD.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">AnyMOD.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Model Elements</span><ul><li><a class="tocitem" href="../model_object/">Model object</a></li><li><a class="tocitem" href="../sets/">Sets and Mappings</a></li><li><a class="tocitem" href="../parts/">Parts</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Parameter</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../parameter_overview/">Parameter overview</a></li><li><a class="tocitem" href="../parameter_list/">Parameter list</a></li></ul></li><li><a class="tocitem" href="../variables/">Variables</a></li><li><a class="tocitem" href="../constraints/">Constraints</a></li></ul></li><li><span class="tocitem">Tools</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Reporting</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../error/">Error handling</a></li><li><a class="tocitem" href="../data/">Data files</a></li><li class="is-active"><a class="tocitem" href>Plots</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Node-trees"><span>Node trees</span></a></li><li class="toplevel"><a class="tocitem" href="#Energy-flow"><span>Energy flow</span></a></li><li class="toplevel"><a class="tocitem" href="#Styling"><span>Styling</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../performance/">Performance and stability</a></li></ul></li><li><span class="tocitem">Annex</span><ul><li><a class="tocitem" href="../tips/">Tips</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../related/">Related material</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tools</a></li><li><a class="is-disabled">Reporting</a></li><li class="is-active"><a href>Plots</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plots</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/leonardgoeke/AnyMOD.jl/blob/master/docs/src/plots.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><style>
table.tabelle2 td {
  padding-left: 0.57em;
  padding-right: 0.57em;
  border-right: solid 1px;
  border-color: #dbdbdb;
  font-size: small;
}
ul.liste {
  list-style-position: outside;
  padding-left: 1em;
  margin-left: 0em;
  margin-top: 0em;
  white-space: nowrap;
  display:inline-block;
  text-align: left;
}
pre.inline {
   display: inline;
}
</style><h1 id="Plots"><a class="docs-heading-anchor" href="#Plots">Plots</a><a id="Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Plots" title="Permalink"></a></h1><p>The graphs that build the conceptual basis for the modelling approach pursued by AnyMOD can be plotted. All plots are created with <a href="https://github.com/plotly/plotly.py">plotly</a> which is accessed from Julia using <a href="https://github.com/JuliaPy/PyCall.jl">PyCall</a>.</p><h1 id="Node-trees"><a class="docs-heading-anchor" href="#Node-trees">Node trees</a><a id="Node-trees-1"></a><a class="docs-heading-anchor-permalink" href="#Node-trees" title="Permalink"></a></h1><p>The <code>plotTree</code> function is used to plot the hierarchical trees of sets as introduced in <a href="../sets/#Sets-and-Mappings">Sets and Mappings</a>.</p><pre><code class="language-julia">plotTree(tree_sym::Symbol, model_object::anyModel)                                </code></pre><p>The input <code>tree_sym</code> indicates which set should be plotted (<code>:region</code>,<code>:timestep</code>,<code>:carrier</code>, or <code>:technology</code>). As an example, the tree for <code>:carrier</code> from the <a href="https://github.com/leonardgoeke/AnyMOD.jl/tree/master/examples/demo">demo problem</a> is plotted below.</p><p style="text-align:center;"><img src="../assets/carrier.png" width="80%"/><p>Optional arguments include:</p><table class="tabelle2">
<tbody>
<tr>
<td><strong>argument</strong></td>
<td><strong>explanation</strong></td>
<td style="border-right:none"><strong>default</strong></td>
</tr>
<tr>
<td><code>plotSize</code></td>
<td>
<ul class="liste">
<li>length and width of the plot in inches</li>
</ul>
</td>
<td style="border-right:none"><code>(8.0,4.5)</code></td>
</tr>
<tr>
<td><code>fontSize</code></td>
<td>
<ul class="liste">
<li>font size of labels in plot</li>
</ul>
</td>
<td style="border-right:none"><code>12</code></td>
</tr>
<tr>
<td><code>useColor</code></td>
<td>
<ul class="liste">
<li>if <code>true</code>, tries to obtain <a href="#Styling">node specific colors</a>, otherwise the same color is used for all nodes</li>
</ul>
</td>
<td style="border-right:none"><code>true</code></td>
</tr>
<tr>
<td><code>wide</code></td>
<td>
<ul class="liste">
<li>controls ratio of horizontal distances between nodes that are on the same level, but have <br> different ancestors (e.g. distance between 'synthetic gas' and 'natural gas' relative to <br> distance between 'natural gas' and 'district heat')</li>
<li>first element of input array refers to ratio on the first level and so on</li>
</ul>
</td>
<td style="border-right:none"><code>fill(1.0,30)</code></td>
</tr>
</tbody>
</table><h1 id="Energy-flow"><a class="docs-heading-anchor" href="#Energy-flow">Energy flow</a><a id="Energy-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-flow" title="Permalink"></a></h1><p>The <code>plotEnergyFlow</code> function provides two ways to visualize the flow of energy within a model: Either as a qualitative node graph or as a quantitative Sankey diagram.</p><h3 id="Node-graph"><a class="docs-heading-anchor" href="#Node-graph">Node graph</a><a id="Node-graph-1"></a><a class="docs-heading-anchor-permalink" href="#Node-graph" title="Permalink"></a></h3><p>To plot a qualitative node graph use the <code>plotEnergyFlow</code> command with the <code>:graph</code> argument.</p><pre><code class="language-julia">plotEnergyFlow(:graph, model_object::anyModel)</code></pre><p>Nodes either correspond to technologies (grey dots) or energy carriers (colored squares). Edges between technology and energy carrier nodes indicate the carrier is either an input (entering edge) or an output (leaving edge) of the respective technology. Edges between carriers result from inheritance relationships between carriers. These are included, because, according to AnyMOD&#39;s graph-based approach, descendants can satisfy the demand for an ancestral carrier (see <a href="https://arxiv.org/abs/2004.10184">Göke (2020)</a> for details).</p><p style="text-align:center;"><img src="../assets/energyFlowGraph.png"/><p>The layout of the graph is created using a <a href="https://en.wikipedia.org/wiki/Force-directed_graph_drawing">force-directed drawing algorithm</a> originally implemented in <a href="https://github.com/IainNZ/GraphLayout.jl">GraphLayout.jl</a>.</p><p>In many cases the resulting layout will be sufficient to get an overview of energy flows for debugging, but inadequate for publication. For this reason, the <code>moveNode!</code> function can be used to adjust the layout.</p><pre><code class="language-julia">moveNode!(model_object::anyModel, newPos_arr::Array{Tuple{String,Array{Float64,1}},1})</code></pre><p><code>moveNode!</code> requires an initial layout within that specific nodes are moved. In the example below, an initial layout is created by calling <code>plotEnergyFlow</code>. Afterwards, the node for &#39;ocgt&#39; is moved 0.2 units to the right and 0.1 units up. The node for &#39;coal&#39; is moved accordingly. Afterwards, the graph is plotted again with the new layout.</p><pre><code class="language-julia">plotEnergyFlow(:graph, model_object)
moveNode!(model_object, [(&quot;ocgt&quot;,[0.2,0.1]),(&quot;coal&quot;,[0.15,0.0])])
plotEnergyFlow(:graph, model_object, replot = false)</code></pre><p>When plotting again, it is important to set the optional <code>replot</code> argument to <code>false</code>. Otherwise, the original layout algorithm will be run again and overwrite any changes made manually.</p><p>Optional arguments for plotting the qualitative node graph are listed below:</p><table class="tabelle2">
<tbody>
<tr>
<td><strong>argument</strong></td>
<td><strong>explanation</strong></td>
<td style="border-right:none"><strong>default</strong></td>
</tr>

<tr>
<td><code>plotSize</code></td>
<td>
<ul class="liste">
<li>length and width of the plot in inches</li>
</ul>
</td>
<td style="border-right:none"><code>(16.0,9.0)</code></td>
</tr>

<tr>
<td><code>fontSize</code></td>
<td>
<ul class="liste">
<li>font size of labels in plot</li>
</ul>
</td>
<td style="border-right:none"><code>12</code></td>
</tr>

<tr>
<td><code>useTeColor</code></td>
<td>
<ul class="liste">
<li>if <code>true</code>, tries to obtain <a href="#Styling">node specific colors</a> for technologies, otherwise <br> technology nodes are displayed in grey</li>
</ul>
</td>
<td style="border-right:none"><code>false</code></td>
</tr>

<tr>
<td><code>replot</code></td>
<td>
<ul class="liste">
<li>if <code>false</code>, the current layout of the plot is used instead of computing a new one</li>
</ul>
</td>
<td style="border-right:none"><code>true</code></td>
</tr>

<tr>
<td><code>scaDist</code></td>
<td rowspan="3"; style="border-bottom:none">
<ul class="liste">
<li>control parameters for the graph's layout algorithm (see <a href="https://github.com/IainNZ/GraphLayout.jl/blob/master/src/spring.jl">spring.jl</a> for original <br> implementation)</li>
</ul>
</td>
<td style="border-right:none"><code>0.5</code></td>
</tr>

<tr>
<td><code>maxIter</code></td>
<td style="border-right:none"><code>5000</code></td>
</tr>

<tr>
<td><code>initTemp</code></td>
<td style="border-right:none"><code>2.0</code></td>
</tr>

</tbody>
</table><h3 id="Sankey-diagram"><a class="docs-heading-anchor" href="#Sankey-diagram">Sankey diagram</a><a id="Sankey-diagram-1"></a><a class="docs-heading-anchor-permalink" href="#Sankey-diagram" title="Permalink"></a></h3><p>To plot the qualitative energy flows for a solved model use <code>plotEnergyFlow</code> command with the <code>:sankey</code> argument:</p><pre><code class="language-julia">plotEnergyFlow(:sankey, model_object::anyModel)</code></pre><p class="norm">
The command will create an entire <a href="../assets/sankey_example.html">html application</a> including a dropdown menu and drag-and-drop capabilities. Below is a screenshot of one graph from the solved <a href="https://github.com/leonardgoeke/AnyMOD.jl/tree/master/examples/demo">demo problem</a>.
</p><p><img src="../assets/sankey.png" alt/></p><p>Optional arguments for plotting a Sankey diagram are:</p><table class="tabelle2">
<tbody>
<tr>
<td><strong>argument</strong></td>
<td><strong>explanation</strong></td>
<td style="border-right:none"><strong>default</strong></td>
</tr>

<tr>
<td><code>plotSize</code></td>
<td>
<ul class="liste">
<li>length and width of the plot in inches</li>
</ul>
</td>
<td style="border-right:none"><code>(16.0,9.0)</code></td>
</tr>

<tr>
<td><code>minVal</code></td>
<td>
<ul class="liste">
<li>threshold for energy flows being plotted</li>
</ul>
</td>
<td style="border-right:none"><code>0.1</code></td>
</tr>

<tr>
<td><code>filterFunc</code></td>
<td>
<ul class="liste">
<li>function to filter certain carriers and technologies from graph</li>
<li>for example <code>x -> x.C == 1</code> will only include flows associated to the energy carrier with <br> id 1 (see documentation of <a href="../api/#AnyMOD.Tree"><code>tree objects</code></a> on how to obtain ids)</li>
</ul>
</td>
<td style="border-right:none"><code>x -> true</code></td>
</tr>

<tr>
<td><code>dropDown</code></td>
<td>
<ul class="liste">
<li>for each relevant set of the dimensions specified here separate diagrams are created, sets <br> then appear in the dropdown menu within the html output</li>
<li>for example <code>dropDown = (:timestep)</code> will create diagrams aggregating values <br> across all regions, instead of creating a separate diagram for each region</li>
</ul>
</td>
<td style="border-right:none"><code>(:region,:timestep)</code></td>
</tr>

<tr>
<td><code>rmvNode</code></td>
<td>
<ul class="liste">
<li>removes specified nodes from the Sankey diagram</li>
<li>removal is only possible for nodes that either only have an in- or outgoing flow or exactly <br> one in- and exactly one outgoing flow of equal size</li>
<li>in the diagram above for instance, the nodes for 'district heat' or 'curtailment' could be <br> removed, but not for 'ocgt'</li>
</ul>
</td>
<td style="border-right:none"><code>tuple()</code></td>
</tr>

<tr>
<td><code>useTeColor</code></td>
<td>
<ul class="liste">
<li>if <code>true</code>, tries to obtain <a href="#Styling">node specific colors</a> for technologies, otherwise technology nodes <br> are displayed in grey</li>
</ul>
</td>
<td style="border-right:none"><code>true</code></td>
</tr>

</tbody>
</table><h1 id="Styling"><a class="docs-heading-anchor" href="#Styling">Styling</a><a id="Styling-1"></a><a class="docs-heading-anchor-permalink" href="#Styling" title="Permalink"></a></h1><p>The colors and labels of nodes within plots can be adjusted using the <code>graInfo</code> field of the model object.</p><p>The sub-field <code>graInfo.names</code> provides a dictionary that maps node names as specified in the input files to node labels used for plotting. By default, some names occurring in the <a href="https://github.com/leonardgoeke/AnyMOD.jl/tree/master/examples/demo">demo problem</a> are already assigned labels within the dictionary.</p><p>Analogously, <code>graInfo.colors</code> assigns colors used for plotting to nodes. Both the actual node name or an assigned label can serve as a key. The assigned value is a tuple of three numbers between 0 and 1 corresponding to a RGB color code.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../data/">« Data files</a><a class="docs-footer-nextpage" href="../performance/">Performance and stability »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 21 March 2021 13:53">Sunday 21 March 2021</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
